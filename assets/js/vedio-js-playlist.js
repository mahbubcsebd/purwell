/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.17.1.
 * Original file: /npm/videojs-playlist@5.1.0/dist/videojs-playlist.es.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"/npm/video.js@8.3.0/+esm";
/*! @name videojs-playlist @version 5.1.0 @license Apache-2.0 */let t=e=>{const t=e.playlist.autoadvance_;t.timeout&&e.clearTimeout(t.timeout),t.trigger&&e.off("ended",t.trigger),t.timeout=null,t.trigger=null};const r=(e,n)=>{var l;(t(e),"number"==typeof(l=n)&&!isNaN(l)&&l>=0&&l<1/0)?(e.playlist.autoadvance_.delay=n,e.playlist.autoadvance_.trigger=function(){const l=()=>r(e,n);e.one("play",l),e.playlist.autoadvance_.timeout=e.setTimeout((()=>{t(e),e.off("play",l),e.playlist.next()}),1e3*n)},e.one("ended",e.playlist.autoadvance_.trigger)):e.playlist.autoadvance_.delay=null};let n=1;const l=e=>{let t=e;return e&&"object"==typeof e||(t=Object(e),t.originalValue=e),t.playlistItemId_=n++,t},a=e=>e.map(l),i=(e,t)=>{let r=e,n=t;return"object"==typeof e&&(r=e.src),"object"==typeof t&&(n=t.src),/^\/\//.test(r)&&(n=n.slice(n.indexOf("//"))),/^\/\//.test(n)&&(r=r.slice(r.indexOf("//"))),r===n},o=(e,t)=>{for(let r=0;r<e.length;r++){const n=e[r].sources;if(Array.isArray(n))for(let e=0;e<n.length;e++){const l=n[e];if(l&&i(l,t))return r}}return-1};function s(n,l,i=0){let s=null,c=!1;const u=n.playlist=(e,t=0)=>{if(c)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(e)){const r=Array.isArray(s)?s.slice():null;s=a(e),c=!0,n.trigger({type:"duringplaylistchange",nextIndex:t,nextPlaylist:e,previousIndex:u.currentIndex_,previousPlaylist:r||[]}),c=!1,-1!==t&&u.currentItem(t),r&&n.setTimeout((()=>{n.trigger({type:"playlistchange",action:"change"})}),0)}return s.map((e=>e.originalValue||e))};return n.on("loadstart",(()=>{-1===u.currentItem()&&t(n)})),u.currentIndex_=-1,u.player_=n,u.autoadvance_={},u.repeat_=!1,u.currentPlaylistItemId_=null,u.currentItem=e=>{if(c)return u.currentIndex_;if("number"==typeof e&&u.currentIndex_!==e&&e>=0&&e<s.length)return u.currentIndex_=e,((e,t)=>{const n=!e.paused()||e.ended();e.trigger("beforeplaylistitem",t.originalValue||t),t.playlistItemId_&&(e.playlist.currentPlaylistItemId_=t.playlistItemId_),e.poster(t.poster||""),e.src(t.sources),(e=>{const t=e.remoteTextTracks();let r=t&&t.length||0;for(;r--;)e.removeRemoteTextTrack(t[r])})(e),e.ready((()=>{if((t.textTracks||[]).forEach(e.addRemoteTextTrack.bind(e)),e.trigger("playlistitem",t.originalValue||t),n){const t=e.play();void 0!==t&&"function"==typeof t.then&&t.then(null,(e=>{}))}r(e,e.playlist.autoadvance_.delay)}))})(u.player_,s[u.currentIndex_]),e>0&&n.poster(""),u.currentIndex_;const t=u.player_.currentSrc()||"";if(u.currentPlaylistItemId_){const e=((e,t)=>{for(let r=0;r<e.length;r++)if(e[r].playlistItemId_===t)return r;return-1})(s,u.currentPlaylistItemId_),r=s[e];if(r&&Array.isArray(r.sources)&&o([r],t)>-1)return u.currentIndex_=e,u.currentIndex_;u.currentPlaylistItemId_=null}return u.currentIndex_=u.indexOf(t),u.currentIndex_},u.add=(e,t)=>{if(c)throw new Error("cannot modify a playlist that is currently changing");("number"!=typeof t||t<0||t>s.length)&&(t=s.length),Array.isArray(e)||(e=[e]),s.splice(t,0,...a(e)),n.trigger({type:"playlistchange",action:"add"}),n.trigger({type:"playlistadd",count:e.length,index:t})},u.remove=(e,t=1)=>{if(c)throw new Error("cannot modify a playlist that is currently changing");"number"!=typeof e||e<0||e>s.length||(s.splice(e,t),n.trigger({type:"playlistchange",action:"remove"}),n.trigger({type:"playlistremove",count:t,index:e}))},u.contains=e=>-1!==u.indexOf(e),u.indexOf=e=>{if("string"==typeof e)return o(s,e);const t=Array.isArray(e)?e:e.sources;for(let e=0;e<t.length;e++){const r=t[e];if("string"==typeof r)return o(s,r);if(r.src)return o(s,r.src)}return-1},u.currentIndex=()=>u.currentItem(),u.lastIndex=()=>s.length-1,u.nextIndex=()=>{const e=u.currentItem();if(-1===e)return-1;const t=u.lastIndex();return u.repeat_&&e===t?0:Math.min(e+1,t)},u.previousIndex=()=>{const e=u.currentItem();return-1===e?-1:u.repeat_&&0===e?u.lastIndex():Math.max(e-1,0)},u.first=()=>{if(c)return;const e=u.currentItem(0);if(s.length)return s[e].originalValue||s[e];u.currentIndex_=-1},u.last=()=>{if(c)return;const e=u.currentItem(u.lastIndex());if(s.length)return s[e].originalValue||s[e];u.currentIndex_=-1},u.next=()=>{if(c)return;const e=u.nextIndex();if(e!==u.currentIndex_){const t=u.currentItem(e);return s[t].originalValue||s[t]}},u.previous=()=>{if(c)return;const e=u.previousIndex();if(e!==u.currentIndex_){const t=u.currentItem(e);return s[t].originalValue||s[t]}},u.autoadvance=e=>{r(u.player_,e)},u.repeat=t=>void 0===t?u.repeat_:"boolean"==typeof t?(u.repeat_=!!t,u.repeat_):void e.log.error("videojs-playlist: Invalid value for repeat",t),u.sort=e=>{s.length&&(s.sort(e),c||n.trigger("playlistsorted"))},u.reverse=()=>{s.length&&(s.reverse(),c||n.trigger("playlistsorted"))},u.shuffle=({rest:e}={})=>{let t=0,r=s;e&&(t=u.currentIndex_+1,r=s.slice(t)),r.length<=1||((e=>{let t=-1;const r=e.length-1;for(;++t<e.length;){const n=t+Math.floor(Math.random()*(r-t+1)),l=e[n];e[n]=e[t],e[t]=l}})(r),e&&s.splice(...[t,r.length].concat(r)),c||n.trigger("playlistsorted"))},Array.isArray(l)?u(l,i):s=[],u}const c=function(e,t){s(this,e,t)};(e.registerPlugin||e.plugin)("playlist",c),c.VERSION="5.1.0";export{c as default};
//# sourceMappingURL=/sm/75aa59d237af0c264b5d5a9bd4a57d0b57ddb970b7858285b51bf318d679669c.map